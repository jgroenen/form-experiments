<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name='viewport' content='width=320,initial-scale=1,user-scalable=0'>
  <link rel="stylesheet" href="../assets/css/style.css">
  <script src="https://unpkg.com/vue"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body>

<div id="app">

  <div v-for="question in questions">

    <div v-if="question.type === 'ja-nee-vraag'">

      <div class="form-builder-vraag ja-nee-vraag">
        <h3>{{ question.wet }}</h3>
        <h2>{{ question.text }}</h2>
        <div>
          <label><input type="radio" :name="question.id" value="ja" v-model="question.antwoord">Ja</label>
          <label><input type="radio" :name="question.id" value="nee" v-model="question.antwoord">Nee</label>
        </div>
      </div>

    </div>

    <div v-if="question.type === 'ja-nee-nvt-vraag'">

      <div class="form-builder-vraag ja-nee-vraag">
        <h3>{{ question.wet }}</h3>
        <h2>{{ question.text }}</h2>
        <div>
          <label><input type="radio" :name="question.id" value="ja" v-model="question.antwoord">Ja</label>
          <label><input type="radio" :name="question.id" value="nee" v-model="question.antwoord">Nee</label>
          <label><input type="radio" :name="question.id" value="nvt" v-model="question.antwoord">NVT</label>
        </div>
      </div>

    </div>

    <div v-if="question.type === 'open-vraag'">

      <div class="form-builder-vraag open-vraag">
        <h3>{{ question.wet }}</h3>
        <h2>{{ question.text }}</h2>
        <div>
          <label><input type="text" :name="question.id" v-model="question.antwoord"></label>
        </div>
      </div>

    </div>

  </div>

</div>
<script>
  Vue.config.devtools = true;
  var formId = window.location.pathname.match(/\/form-(.*)\//)[1];
  var apiEndpoint = `/api/form-${formId}.json`;
  var app = new Vue({
    el: '#app',
    computed: {
      test2: function (vue) {
        return vue.test + "---";
      }
    },
    mounted() {
      //if (localStorage.getItem("questions")) {
      //  this.questions = JSON.parse(localStorage.getItem("questions"));
      //}
      axios
        .get(apiEndpoint)
        .then(response => this.questions = response.data.questions)
    },
    watch: {
      questions: {
        handler() {
          localStorage.setItem("questions", JSON.stringify(this.questions));
          axios
            .post(apiEndpoint)
            .then(response => console.log(response))
        },
        deep: true
      }
    },
    data: {
      questions: []
    }
  });
</script>

</body>
</html>
